package com.portfolio.controller;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.ArrayList;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;

import com.portfolio.entity.Curso_Complementar;
import com.portfolio.entity.Experiencia;
import com.portfolio.entity.Experiencia_Atividade;
import com.portfolio.entity.Formacao;
import com.portfolio.entity.Projetos;
import com.portfolio.entity.Sobre;
import com.portfolio.service.Curso_ComplementarService;
import com.portfolio.service.ExperienciaService;
import com.portfolio.service.Experiencia_AtividadeService;
import com.portfolio.service.FormacaoService;
import com.portfolio.service.ProjetosService;
import com.portfolio.service.SobreService;

@Controller
@RequestMapping(value = { "/index", "/" })
public class ControllerVisitante {

	@Autowired
	private SobreService sobreService;

	@Autowired
	private FormacaoService formacaoService;

	@Autowired
	private Curso_ComplementarService cursosService;

	@Autowired
	private ProjetosService projetosService;

	@Autowired
	private Experiencia_AtividadeService atividadeService;

	@Autowired
	private ExperienciaService empresasService;

	@GetMapping
	public ModelAndView home() {

		Sobre sobre = sobreService.obter(1L);

		ArrayList<Formacao> formacao = (ArrayList<Formacao>) formacaoService.listar();

		ArrayList<Curso_Complementar> cursos = (ArrayList<Curso_Complementar>) cursosService.listar();

		ArrayList<Projetos> projeto = (ArrayList<Projetos>) projetosService.listar();

		ArrayList<Experiencia_Atividade> atividades = (ArrayList<Experiencia_Atividade>) atividadeService.listar();

		ArrayList<Experiencia> empresas = (ArrayList<Experiencia>) empresasService.listar();

		ModelAndView modelAndView = new ModelAndView("index").addObject("sobre", sobre).addObject("formacoes", formacao)
				.addObject("cursos", cursos).addObject("projetos", projeto).addObject("empresas", empresas)
				.addObject("atividades", atividades);
		return modelAndView;
	}

	@RequestMapping(value = "/download")
    public HttpEntity<byte[]> download() throws IOException {

    	byte[] arquivo = //pega os bytes de qualquer arquivo
    		    
    	HttpHeaders httpHeaders = new HttpHeaders();

    	httpHeaders.add("Content-Disposition", "attachment;filename=\""+"Curricula.docx"+"\"");

    	HttpEntity<byte[]> entity = new HttpEntity<byte[](arquivo,httpHeaders);

    	return entity;

    }

}
